% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simjm.R
\name{simjm}
\alias{simjm}
\title{Simulate data for a univariate or multivariate joint model}
\usage{
simjm(n = 200, M = 1, random_trajectory = "linear", assoc = "etavalue",
  basehaz = c("weibull"), betaLong_intercept = 0, betaLong_binary = 1,
  betaLong_continuous = 1, betaLong_slope = 1, betaLong_aux = 1,
  betaEvent_intercept = -4, betaEvent_binary = 1,
  betaEvent_continuous = 0, betaEvent_assoc = 0.2, betaEvent_aux = 1.2,
  b_sd = c(2, 1), b_rho = -0.2, prob_Z1 = 0.5, mean_Z2 = 0, sd_Z2 = 1,
  max_yobs = 10, max_fuptime = 5, family = gaussian,
  seed = sample.int(.Machine$integer.max, 1), interval = c(0, 200))
}
\arguments{
\item{n}{Number of subjects}

\item{M}{Number of longitudinal markers}

\item{random_trajectory}{The desired type of trajectory in the random effects
part of the longitudinal model}

\item{assoc}{The desired type of association structure for the joint model.
Only one association structure type can be specified. The options are:
\code{"etavalue"}, \code{"etaslope"}, \code{"shared_b(1)"},
\code{"shared_coef(1)"}, \code{"shared_b(2)"}, \code{"shared_coef(2)"}.}

\item{basehaz}{The desired baseline hazard for the event submodel. Can be
\code{"weibull"}.}

\item{betaLong_intercept}{True intercept in the longitudinal submodel. Can
be a scalar or a vector of length M.}

\item{betaLong_binary}{True coefficient for the binary covariate in the
longitudinal submodel. Can be a scalar or a vector of length M.}

\item{betaLong_continuous}{True coefficient for the continuous covariate in the
longitudinal submodel. Can be a scalar or a vector of length M.}

\item{betaLong_slope}{True coefficient for the fixed effect slope in the
longitudinal submodel. Can be a scalar or a vector of length M.}

\item{betaLong_aux}{True parameter value for the auxiliary parameter in the
longitudinal submodel (sigma for Gaussian models, number of trials for
binomial models, size for negative binomial models, shape for Gamma models,
lambda for inverse Gaussian models). Can be a scalar or a vector of length M.}

\item{betaEvent_intercept}{True intercept term (log hazard scale) in the
event submodel. Only required for Weibull models.}

\item{betaEvent_binary}{True coefficient (log hazard ratio) for the binary
covariate in the event submodel.}

\item{betaEvent_continuous}{True coefficient (log hazard ratio) for the
continuous covariate in the event submodel.}

\item{betaEvent_assoc}{True association parameter (log hazard ratio) in the
event submodel. Can be a scalar or a vector of length M.}

\item{betaEvent_aux}{True parameter value(s) for the auxiliary parameter(s) in
the event submodel (shape parameter for Weibull models). Can be a scalar
or a vector, depending on how many auxiliary parameters are required for
specifying the baseline hazard.}

\item{b_sd}{Vector of standard deviations for the random effects.}

\item{b_rho}{Correlation between the random effects.}

\item{prob_Z1}{Probability for the binary covariate included in each of the
submodels.}

\item{mean_Z2}{Mean of the (normally distributed) continuous covariate included
in each of the submodels.}

\item{sd_Z2}{Standard deviation of the (normally distributed) continuous
covariate included in each of the submodels.}

\item{max_yobs}{The maximum allowed number of longitudinal measurements. The
actual number of observed measurements will depend on the individuals event time.}

\item{max_fuptime}{The maximum follow up time in whatever the desired time
units are. This time will also be used as the censoring time (i.e. for subjects
who have a simulated survival time that is after \code{max_fuptime})}

\item{family}{A family for the the longitudinal submodel, or for a multivariate
joint model this can be a list of families. See \code{\link[stats]{glm}} and
\code{\link[stats]{family}}.}

\item{seed}{An optional \code{\link[=set.seed]{seed}}.}

\item{interval}{The interval over which to search for the
\code{\link[stats]{uniroot}} corresponding to each simulated event time.}
}
\value{
A data frame in long format. The data frame also has a number of
  attributes that record the values specified for the arguments in the
  \code{simjm} call (for example the "true" parameter values, the number
  of individuals, the number of longitudinal markers, and so on).
}
\description{
Returns a data frame containing data simulated from a joint model for
longitudinal and time-to-event data.
}
\examples{
#####
# By default simjm will simulate data for three longitudinal biomarkers.
# However, if we only want one or two longitudinal biomarkers then we need to
# adjust the "true" parameters accordingly so that we still get realistic
# survival times. The easiest option is to change the "true" association
# parameter value. Some suggested values that lead to realistic survival
# times are given below.

# For one longitudinal marker:
simdat1 <- simjm(M = 1, betaEvent_assoc = 0.03)

# For two longitudinal markers:
simdat2 <- simjm(M = 2, betaEvent_assoc = 0.015)

# For three longitudinal markers, we can just use the defaults:
simdat3 <- simjm()

# Simulate three markers for just 100 individuals and then return
# the true parameter values (which are stored as an attribute):
simdat4 <- simjm(n = 100)
attr(simdat4, "params")

# Simulate three longitudinal markers, using "etaslope"
# association structure
simdat5 <- simjm(assoc = "etaslope", betaEvent_assoc = 0.3)

# For one longitudinal marker, with a bernoulli outcome.
# (Note that 'betaLong_aux' specifies the number of trials
# for the binomial outcome).
simdat6 <- simjm(M = 1,
                 betaLong_intercept = 1.3,
                 betaLong_binary = -0.6,
                 betaLong_continuous = -0.03,
                 betaLong_slope = 0.05,
                 b_sd = c(1, 0.05),
                 betaEvent_intercept = -9,
                 betaEvent_assoc = 0.05,
                 family = binomial(),
                 betaLong_aux = 1)

}
